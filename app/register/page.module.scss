// Variables
$breakpoint-mobile: 768px;
$sidebar-width: 260px;
$sidebar-bg: #1e1e1e; // Dark gray/black
$sidebar-text: #e0e0e0;
$sidebar-text-muted: #a0a0a0;
$primary-color: #4a9d9c; // Teal/Greenish from button
$input-bg: #2b2b2b;
$input-border: #3e3e3e;
$text-color: #ffffff;
$font-family: "Inter", sans-serif;

// Mixins/Placeholders
%flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

%flex-column {
  display: flex;
  flex-direction: column;
}

.container {
  display: flex;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
  font-family: $font-family;
  background-color: #000;
  color: $text-color;

  // Backdrop for mobile
  .backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 90; // Below sidebar (100) but above everything else
    backdrop-filter: blur(2px);
    display: none; // Hidden by default

    @media (max-width: $breakpoint-mobile) {
      display: block;
    }
  }

  .sidebar {
    width: $sidebar-width;
    background-color: $sidebar-bg;
    display: flex;
    flex-direction: column;
    padding: 20px;
    border-right: 1px solid #333;
    flex-shrink: 0;
    transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 100;
    overflow: hidden; // Prevent content overflow during transition

    // Mobile specific styles
    @media (max-width: $breakpoint-mobile) {
      position: fixed;
      top: 0;
      bottom: 0;
      left: 0;
      transform: translateX(-100%); // Hidden by default
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      width: $sidebar-width !important; // Force full width on mobile drawer
      border-right: none;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);

      &.mobileOpen {
        transform: translateX(0); // Slide in
      }
    }

    // Nav item transitions
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 40px;
      min-height: 32px;
      margin-left: 12px;

      .logo {
        width: 32px;
        height: 32px;
        background-color: $primary-color;
        border-radius: 50%;
        transition: transform 0.2s;
        flex-shrink: 0;

        &:hover {
          transform: scale(1.05);
        }
      }

      .collapseBtn {
        background: none;
        border: none;
        color: $sidebar-text-muted;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 4px;
        border-radius: 4px;
        transition: color 0.2s, background-color 0.2s;
        flex-shrink: 0;

        &:hover {
          color: $sidebar-text;
          background-color: rgba(255, 255, 255, 0.1);
        }

        svg {
          width: 20px;
          height: 20px;
        }
      }
    }

    // Nav item transitions
    .nav {
      @extend %flex-column;
      gap: 10px;
      margin-left: 8px;

      .navItem {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px;
        color: $sidebar-text;
        text-decoration: none;
        border-radius: 8px;
        transition: background-color 0.2s,
          padding 0.4s cubic-bezier(0.4, 0, 0.2, 1),
          gap 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-size: 14px;
        white-space: nowrap;
        overflow: hidden;
        min-height: 40px;
        min-width: 40px;

        &:hover {
          background-color: rgba(255, 255, 255, 0.1);
        }

        &.active {
          background-color: rgba(255, 255, 255, 0.1);
        }

        svg {
          width: 20px;
          height: 20px;
          color: $sidebar-text-muted;
          flex-shrink: 0;
        }

        .navText {
          opacity: 1;
          max-width: 200px;
          transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1),
            max-width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
          display: inline-block;
        }
      }
    }

    .userProfile {
      margin-top: auto;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border: 1px solid #333;
      border-radius: 10px;
      min-height: 54px;

      .avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background-color: #555;
        @extend %flex-center;
        flex-shrink: 0;

        svg {
          width: 20px;
          height: 20px;
          color: $sidebar-text;
        }
      }

      .userName {
        font-size: 14px;
        color: $sidebar-text;
        white-space: nowrap;
        overflow: hidden;
        opacity: 1;
        max-width: 200px;
        transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1),
          max-width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
    }

    // Collapsed specific styles
    &.collapsed {
      width: 80px;
      padding: 20px 10px;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1),
        padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);

      @media (max-width: $breakpoint-mobile) {
        width: $sidebar-width;
        align-items: stretch;
      }

      .header {
        gap: 12px;

        @media (max-width: $breakpoint-mobile) {
          flex-direction: row;
          justify-content: space-between;
          gap: 0;
        }

        .logo {
          margin-bottom: 0;
        }
        .collapseBtn {
          opacity: 0;
          transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
      }

      .nav {
        // margin-left: 7px;
        // transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);

        @media (max-width: $breakpoint-mobile) {
          align-items: stretch;
        }

        .navItem {
          justify-content: flex-start;
          padding: 10px;
          gap: 0;

          @media (max-width: $breakpoint-mobile) {
            justify-content: flex-start;
            width: auto;
            height: auto;
            padding: 10px;
          }

          .navText {
            opacity: 0;
            max-width: 0;
            pointer-events: none;

            @media (max-width: $breakpoint-mobile) {
              opacity: 1;
              max-width: 200px;
              pointer-events: auto;
            }
          }
        }
      }

      .userProfile {
        justify-content: flex-start;
        gap: 0;

        @media (max-width: $breakpoint-mobile) {
          justify-content: flex-start;
        }

        .userName {
          opacity: 0;
          max-width: 0;
          // display: none; // REMOVED
          pointer-events: none;

          @media (max-width: $breakpoint-mobile) {
            opacity: 1;
            max-width: 200px;
            // display: inline;
            pointer-events: auto;
          }
        }
      }
    }
  }

  .mainContent {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    background-image: url("https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=2671&auto=format&fit=crop");
    background-size: cover;
    background-position: center;

    .mobileMenuBtn {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 50;
      background: rgba(30, 30, 30, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 8px;
      color: white;
      cursor: pointer;
      display: none; // Hidden on desktop
      backdrop-filter: blur(4px);

      @media (max-width: $breakpoint-mobile) {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      svg {
        width: 24px;
        height: 24px;
      }
    }

    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(2px);
    }

    .authCard {
      position: relative;
      z-index: 1;
      background: rgba(30, 30, 30, 0.85);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 40px;
      width: 480px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1); // Fixed border color variable reference if it was broken, but looks ok.
      // Actually checking previous code it was rgba(255, 255, 255, 0.1) explicitly.

      @media (max-width: $breakpoint-mobile) {
        width: 90%;
        padding: 24px;
        max-width: 400px;
      }

      .title {
        font-size: 24px;
        font-weight: 600;
        text-align: center;
        margin-bottom: 30px;
        color: $text-color;

        @media (max-width: $breakpoint-mobile) {
          font-size: 20px;
          margin-bottom: 24px;
        }
      }

      .form {
        @extend %flex-column;
        gap: 16px;

        .row {
          display: flex;
          gap: 16px;

          @media (max-width: $breakpoint-mobile) {
            flex-direction: column;
            gap: 16px;
          }

          .inputGroup {
            min-width: 0;
          }
        }

        .inputGroup {
          flex: 1;
          @extend %flex-column;

          input {
            width: 100%;
            background-color: $input-bg;
            border: 1px solid $input-border;
            border-radius: 6px;
            padding: 10px;
            color: $text-color;
            font-size: 14px;
            outline: none;

            &:focus {
              border-color: $primary-color;
            }

            &.error {
              border-color: #ff4d4d;
            }

            &::placeholder {
              color: #666;
            }

            &[type="number"]::-webkit-inner-spin-button,
            &[type="number"]::-webkit-outer-spin-button {
              -webkit-appearance: none;
              margin: 0;
            }
          }

          .errorMessage {
            color: #ff4d4d;
            font-size: 12px;
            margin-top: 4px;
          }
        }

        .submitBtn {
          background-color: $primary-color;
          color: white;
          border: none;
          border-radius: 6px;
          padding: 14px;
          font-size: 16px;
          font-weight: 500;
          cursor: pointer;
          margin-top: 10px;
          transition: opacity 0.2s;

          &:hover {
            opacity: 0.9;
          }
        }
      }

      .divider {
        display: flex;
        align-items: center;
        margin: 24px 0;
        color: #888;
        font-size: 14px;

        &::before,
        &::after {
          content: "";
          flex: 1;
          height: 1px;
          background-color: #444;
        }

        span {
          padding: 0 10px;
        }
      }

      .socialButtons {
        display: flex;
        gap: 16px;
        justify-content: space-between;

        .socialBtn {
          height: 60px;
          flex: 1;
          border-radius: 8px;
          background-color: #111;
          border: 1px solid #333;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          transition: background-color 0.2s;

          &:hover {
            background-color: #222;
          }

          img,
          svg {
            width: 30px;
            height: auto;
            color: white;
          }
        }
      }

      .footer {
        margin-top: 24px;
        text-align: center;
        font-size: 14px;
        color: #ffffffe1;

        strong {
          color: $text-color;
          cursor: pointer;
        }
      }
    }
  }
}
